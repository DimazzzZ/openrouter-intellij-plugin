<!-- Plugin Configuration File. Read more: https://plugins.jetbrains.com/docs/intellij/plugin-configuration-file.html -->
<idea-plugin>
    <!-- Unique identifier of the plugin. It should be FQN. It cannot be changed between the plugin versions. -->
    <id>org.zhavoronkov.openrouter</id>

    <!-- Public plugin name should be written in Title Case.
         Guidelines: https://plugins.jetbrains.com/docs/marketplace/plugin-overview-page.html#plugin-name -->
    <name>OpenRouter</name>

    <!-- A displayed Vendor name or Organization ID displayed on the Plugins Page. -->
    <vendor email="openrouter-plugin@zhavoronkov.org" url="https://github.com/DimazzzZ/openrouter-intellij-plugin">Dmitry Zhavoronkov</vendor>

    <!-- Description of the plugin displayed on the Plugin Page and IDE Plugin Manager.
         Simple HTML elements (text formatting, paragraphs, and lists) can be added inside this element.
         Guidelines: https://plugins.jetbrains.com/docs/marketplace/plugin-overview-page.html#plugin-description -->
    <description><![CDATA[
    <p><strong>OpenRouter IntelliJ Plugin</strong> - Comprehensive integration with <a href="https://openrouter.ai">OpenRouter.ai</a> for accessing 400+ AI models with advanced usage monitoring, quota tracking, and AI Assistant proxy support.</p>

    <h3>Key Features</h3>
    <ul>
        <li><strong>AI Assistant Proxy</strong> - Local OpenAI-compatible proxy to connect JetBrains AI Assistant with OpenRouter's 400+ models</li>
        <li><strong>Interactive Status Bar Widget</strong> - Real-time usage display with comprehensive popup menu</li>
        <li><strong>Advanced API Key Management</strong> - Secure provisioning key support with automatic API key creation</li>
        <li><strong>Detailed Usage Analytics</strong> - Track token consumption, costs, and model performance</li>
        <li><strong>Favorite Models</strong> - Quick access to your preferred AI models</li>
        <li><strong>Real-time Monitoring</strong> - Live connection status with color-coded indicators</li>
        <li><strong>Comprehensive Settings</strong> - Easy configuration with validation and testing</li>
    </ul>

    <h3>Quick Start</h3>
    <ol>
        <li>Get your Provisioning Key from <a href="https://openrouter.ai/settings/provisioning-keys">OpenRouter Provisioning Keys</a></li>
        <li>Configure in <strong>Settings ‚Üí Tools ‚Üí OpenRouter</strong></li>
        <li>Click the status bar widget to access all features</li>
        <li>(Optional) Configure AI Assistant to use OpenRouter via custom server - <a href="https://github.com/DimazzzZ/openrouter-intellij-plugin/blob/main/docs/AI_ASSISTANT_SETUP.md">Setup Guide</a></li>
    </ol>

    <h3>Perfect For</h3>
    <ul>
        <li>Developers using AI models for code assistance via AI Assistant</li>
        <li>Teams monitoring AI usage and costs across multiple models</li>
        <li>Anyone wanting access to 400+ AI models from 40+ providers</li>
    </ul>

    <p><em>This is an unofficial plugin and is not affiliated with OpenRouter.ai or JetBrains.</em></p>
  ]]></description>

    <!-- Product and plugin compatibility requirements.
         Read more: https://plugins.jetbrains.com/docs/intellij/plugin-compatibility.html -->
    <depends>com.intellij.modules.platform</depends>

    <!--
         AI Assistant Integration Note:
         This plugin provides a local proxy server for AI Assistant integration.
         No plugin dependency is needed - AI Assistant connects via custom server configuration.
         See docs/AI_ASSISTANT_SETUP.md for setup instructions.
    -->


    <!-- Change notes for this version -->
    <change-notes><![CDATA[
        <h3>üéâ Version 0.2.1 - OpenRouter models support for 3rd-party AI Assistants (2025-10-04)</h3>
        <ul>
            <li>fix: resolve JetBrains plugin verifier compatibility issues and optimize workflows</li>
        </ul>

        <h3>üéâ Version 0.2.0 - OpenRouter models support for 3rd-party AI Assistants (2025-10-03)</h3>
        <p><strong>New Features:</strong></p>
        <ul>
            <li><strong>ü§ñ AI Assistant Proxy</strong> - Local OpenAI-compatible proxy server to connect JetBrains AI Assistant with OpenRouter's 400+ models</li>
            <li><strong>‚≠ê Favorite Models</strong> - Manage and organize your preferred AI models</li>
            <li><strong>üåê Custom Server Support</strong> - Configure AI Assistant to use OpenRouter via custom model connection</li>
        </ul>

        <p><strong>Improvements:</strong></p>
        <ul>
            <li><strong>207+ Tests</strong> - Comprehensive test coverage with 100% pass rate</li>
            <li><strong>Zero Critical Code Smells</strong> - Enhanced code quality and maintainability</li>
            <li><strong>Better Performance</strong> - API key caching and optimized request handling</li>
            <li><strong>Modern UI</strong> - Updated to IntelliJ UI DSL v2</li>
        </ul>

        <p><a href="https://github.com/DimazzzZ/openrouter-intellij-plugin/blob/main/docs/AI_ASSISTANT_SETUP.md">AI Assistant Setup Guide</a> | <a href="https://github.com/DimazzzZ/openrouter-intellij-plugin/blob/main/CHANGELOG.md">Full Changelog</a></p>

        <hr/>

        <h3>Version 0.1.0 - Initial Release (2025-09-18)</h3>
        <p>First beta release of the OpenRouter IntelliJ Plugin with comprehensive OpenRouter.ai integration.</p>

        <p><strong>Key Features:</strong></p>
        <ul>
            <li><strong>Interactive Status Bar Widget</strong> - Real-time usage display with comprehensive popup menu</li>
            <li><strong>Advanced API Key Management</strong> - Provisioning key support with automatic API key creation</li>
            <li><strong>Detailed Usage Analytics</strong> - Track token consumption, costs, and model performance</li>
            <li><strong>Smart Settings Panel</strong> - Configuration with validation and testing</li>
            <li><strong>Statistics Popup</strong> - Modal dialog with comprehensive usage analytics</li>
            <li><strong>Multi-IDE Support</strong> - Works across all JetBrains IDEs (2023.2+)</li>
        </ul>

        <p><strong>Technical Highlights:</strong></p>
        <ul>
            <li>Secure credential storage using IntelliJ's built-in storage</li>
            <li>Asynchronous API operations for smooth user experience</li>
            <li>Comprehensive error handling and user feedback</li>
            <li>22 passing tests ensuring reliability</li>
        </ul>
    ]]></change-notes>

    <!-- Extension points defined by the plugin.
         Read more: https://plugins.jetbrains.com/docs/intellij/plugin-extension-points.html -->
    <extensions defaultExtensionNs="com.intellij">
        <!-- Notification group for plugin updates and announcements -->
        <notificationGroup id="OpenRouter Updates"
                           displayType="BALLOON"
                           isLogByDefault="true"/>

        <!-- Notification group for model errors and warnings -->
        <notificationGroup id="OpenRouter Errors"
                           displayType="BALLOON"
                           isLogByDefault="true"/>

        <!-- Application-level services -->
        <applicationService serviceImplementation="org.zhavoronkov.openrouter.services.OpenRouterService"/>
        <applicationService serviceImplementation="org.zhavoronkov.openrouter.services.OpenRouterSettingsService"/>
        <applicationService serviceImplementation="org.zhavoronkov.openrouter.services.OpenRouterGenerationTrackingService"/>
        <applicationService serviceImplementation="org.zhavoronkov.openrouter.services.OpenRouterProxyService"/>
        
        <!-- Settings -->
        <applicationConfigurable
            parentId="tools"
            instance="org.zhavoronkov.openrouter.settings.OpenRouterConfigurable"
            id="org.zhavoronkov.openrouter.settings.OpenRouterConfigurable"
            displayName="OpenRouter"/>

        <!-- Favorite Models sub-page -->
        <applicationConfigurable
            parentId="org.zhavoronkov.openrouter.settings.OpenRouterConfigurable"
            instance="org.zhavoronkov.openrouter.settings.FavoriteModelsConfigurable"
            id="org.zhavoronkov.openrouter.settings.FavoriteModelsConfigurable"
            displayName="Favorite Models"/>
        
        <!-- Status bar widget -->
        <statusBarWidgetFactory
            implementation="org.zhavoronkov.openrouter.statusbar.OpenRouterStatusBarWidgetFactory"
            id="OpenRouterStatusBar"
            order="after Encoding"/>

        <!-- Startup activities -->
        <postStartupActivity implementation="org.zhavoronkov.openrouter.startup.ProxyServerStartupActivity"/>
        <postStartupActivity implementation="org.zhavoronkov.openrouter.startup.WhatsNewNotificationActivity"/>
        
        <!-- Tool window - TEMPORARILY DISABLED -->
        <!--
        <toolWindow
            id="OpenRouter"
            secondary="true"
            icon="org.zhavoronkov.openrouter.icons.OpenRouterIcons.TOOL_WINDOW"
            anchor="right"
            factoryClass="org.zhavoronkov.openrouter.toolwindow.OpenRouterToolWindowFactory"/>
        -->
    </extensions>

    <!-- Actions -->
    <actions>
        <group id="OpenRouter.ActionGroup" text="OpenRouter" description="OpenRouter actions">
            <add-to-group group-id="ToolsMenu" anchor="last"/>

            <action id="OpenRouter.ShowUsage"
                    class="org.zhavoronkov.openrouter.actions.ShowUsageAction"
                    text="Show Usage Statistics"
                    description="Display OpenRouter API usage statistics"/>

            <action id="OpenRouter.RefreshQuota"
                    class="org.zhavoronkov.openrouter.actions.RefreshQuotaAction"
                    text="Refresh Quota"
                    description="Refresh OpenRouter API quota information"/>

            <action id="OpenRouter.OpenSettings"
                    class="org.zhavoronkov.openrouter.actions.OpenSettingsAction"
                    text="Settings..."
                    description="Open OpenRouter settings"/>
        </group>
    </actions>
</idea-plugin>
